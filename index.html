<!DOCTYPE html>
<html>
  <body>
    <h1>Hello World</h1>
    <img src="jackma.jpg">
    <button id="mybutton">Click me</button>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.0.0-alpha.1/axios.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- Require the peer dependencies of face-landmarks-detection. -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>

    <!-- You must explicitly require a TF.js backend if you're not using the TF.js union bundle. -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/face-landmarks-detection"></script>
    <script src="index.js"></script>

    <script>
      const model = faceLandmarksDetection.SupportedModels.MediaPipeFaceMesh;
      const detectorConfig = {
        runtime: "mediapipe",
        solutionPath: "https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh",
        // or 'base/node_modules/@mediapipe/face_mesh' in npm.
      };

      async function PrintInfo(image) {
        const detector = await faceLandmarksDetection.createDetector(
          model,
          detectorConfig
        );
        const estimationConfig = { flipHorizontal: false };
        let faces = await detector.estimateFaces(image, estimationConfig);
        return faces;
      }
      // console.log(PrintInfo(document.querySelector("img")))
      $(document).ready(function () {
        $("#mybutton").click(function () {
          var result = PrintInfo(document.querySelector("img"));
          var data = result.then((data) => {
            // console.log(JSON.stringify(data));
            // console.log(result);

            var sc = JSON.stringify({
              KeyPoints: data[0].keypoints,
              Boxes: data[0].box,
            });
            console.log(sc);
            fetch("https://localhost:44396/api/Python", {
              method: "POST",
              headers: {
                Accept: "application/json",
                "Content-Type": "application/json",
              },
              body: sc,
            })
              .then((response) => console.log(response.json()))
              .catch((error) => console.error("Unable to add item.", error));
          });
          data;
        });
      });
    </script>
  </body>
</html>
